{% extends "base.html" %}
{% block head %}
<title>{{ mod.capitalize() }} View Page</title>
{% endblock %}

{% block header %}
{{ super() }}
<h1>
  {{ mod.capitalize() }} Details
  {% if data.name %}for {{ data.name }}{% endif %}
</h1>
{% endblock header %}
{% block content %}

{% block data_view %}
<ul>
{% for key in data.keys() %}
  {% if key == 'insights' and data[key]|length %}
  <li><a href="{{ url_for('insights', mod=mod, id=data.id) }}">See Insights</a> </li>
  {% elif key == 'audiences' and data[key]|length %}
  <li> {{ key }} </li>
    <ul>
    {% for ea in data[key] %}
      <li><a href="{{ url_for('view', mod=key, id=ea.id) }}">
        {{ ea.name }} as of {{ea.recorded}}</a>
      </li>
    {% else %}
      <li>None</li>
    {% endfor %}
    </ul>
  {% elif key in ['facebook_id', 'instagram_id'] %}
  <li>{{key}}: {%if data[key] is none %} Not {% endif %} Known</li>
  {% elif key not in data['related'] and key != 'related' %}
  <li>{{key}}: {{data[key]}} </li>
  {% endif %}
{% else %}
  <li>No Data</li>
{% endfor %}
</ul>
{% endblock data_view %}

{% block modify %}
{% if mod in ['influencer', 'brand', 'admin', 'manager', 'campaign', 'insight', 'audience'] %}
<h3>Change Data Actions</h3>
<ul>
  {% if mod in ['influencer', 'brand'] and data['instagram_id'] %}
  <li><a href="{{ url_for('new_post', mod=mod, id=data.id) }}">Get New Media / Posts</a> </li>
  <li><a href="{{ url_for('new_insight', mod=mod, id=data.id) }}">Get New {{mod|title}} Insights</a> </li>
  <li><a href="{{ url_for('new_audience', mod=mod, id=data.id) }}">Get New Audience Data</a> </li>
  <li><a href="{{ url_for('export', mod=mod, id=data.id)}}">Export Data to a Google Sheet</a></li>
  {% endif %}
  <li>CAREFUL BELOW!</li>
  <li><a href="{{ url_for('edit', mod=mod, id=data.id) }}">Update {{ mod|title }}</a></li>
  {% if current_user.role == 'admin' or (current_user.id == data.id and current_user.role == mod) %}
  <li><a href="{{ url_for('delete', mod=mod, id=data.id) }}">Delete {{ mod|title }}</a></li>
  {% endif %}
</ul>
{% endif %}
{% endblock modify %}

{% endblock content %}

{% if mod in ['influencer', 'brand', 'admin', 'manager'] %}
<li><a href="{{ url_for('backup_save', mod=mod, id=data.id )}}">Admin - Log {{mod|title}} Data</a> </li>
{% endif %}
<li><a href="{{ url_for('followers', mod=mod, id=data.id) }}">Get Online Followers Report</a></li>
